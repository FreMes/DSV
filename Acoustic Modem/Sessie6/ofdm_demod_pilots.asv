function [rxQamStream, channel_est] = ofdm_demod_pilots(Rx,N,L_CP,trainblock,P)  
%           serial-parallel:
    receivedparallel = reshape(Rx,N + L_CP,P);
    receivedparallelnocp = receivedparallel(L_CP+1:N+L_CP,:);

    packet_received = fft(receivedparallelnocp,N); %FFT

    packett = packet_received(2:2:end,:);
    packetd = packet_received(3:2:N/2-1,:);
             
    estH = packett./repmat([trainblock;conj(flipud(trainblock))],1,P); 

    channel_est_pilots = zeros(N,P);
    channel_est_pilots(1:2:end,:) = estH;    %interpolatie
    htest = real(ifft(channel_est_pilots,N));
    channel_est = fft(htest(1:110,:),N);    %LP filter
    
     channel_est = repmat([0.0162347412109375 + 0.00000000000000i;-0.0422749463202110 + 0.0405747642497566i;-0.0382808853327221 - 0.0200561180921658i;-0.00358054940723795 - 0.00229418123580474i;0.000367564466351748 - 0.0146857500857929i;0.00129675694907157 + 0.000516387108681213i;-0.00335964274139229 - 0.00631631036688940i;-0.0273041397129701 + 0.00478292159947905i;-0.00940108282148506 + 0.000147610288721709i;-0.00208413372040777 + 0.00983238817301692i;-0.00268686011712669 + 0.00727217667218528i;0.00845581914439554 + 0.00387048165844497i;0.0117908549301265 - 0.000378047020321038i;0.0226708141218227 - 0.0234579334645852i;-0.0299092242827132 - 0.0365345960400933i;-0.0522823062311627 - 0.00212336424984206i;-0.0490006746043663 + 0.0275307554384524i;-0.0225572394558732 + 0.0592930695044879i;0.0505949921308971 + 0.0646566273135022i;0.0435158313404098 + 0.0202034460915909i;0.0345142021386878 + 0.0210122532636355i;0.0232951369021420 - 0.00346971195142102i;0.0126369810011458 + 0.000262600587259238i;-0.00719753257612951 + 0.00549519938167638i;0.0186438185551273 + 0.0187395250191680i;0.0152258876083884 + 0.0807562227802350i;0.0804985736320079 + 0.0684392087778033i;0.144943727448516 + 0.0778175248431117i;0.197298077717305 - 0.0450272907468386i;0.166554672049608 - 0.185047592513926i;0.0569408011947115 - 0.281808544784904i;-0.107659359229499 - 0.298720087679902i;-0.175806212485551 - 0.196430104698557i;-0.259404984686327 - 0.101964186112656i;-0.248353193619903 - 0.00100781015329328i;-0.216704967608849 + 0.0632272190871281i;-0.228785094796284 + 0.126913083744720i;-0.153676638235634 + 0.200429201600013i;-0.103360637969971 + 0.259035931534960i;-0.0227604228872568 + 0.271700254609744i;0.0942101212521723 + 0.273431179359133i;0.176963251898272 + 0.207633972459545i;0.244268298139887 + 0.119212559373841i;0.246771081042966 + 0.0386790766141766i;0.229552866478961 - 0.0217906472771969i;0.153137060968825 - 0.117705631198029i;0.138971966117350 - 0.0983227903551719i;0.0790817583436108 - 0.153839556332606i;0.0486777333286202 - 0.145940318016716i;0.0271850978971708 - 0.155018556686167i;-0.0132004980389885 - 0.147640542784997i;-0.0522689694336260 - 0.151978823677644i;-0.0915362573618112 - 0.120870741449549i;-0.121022640233632 - 0.0743951129863777i;-0.125068088207384 - 0.0419056490826946i;-0.133058915121188 + 0.0193850442269401i;-0.100654795289144 + 0.00980936521224955i;-0.0962113628137208 + 0.0186574440413172i;-0.0775831910582389 + 0.0303897023891404i;-0.0697606000706588 + 0.0334513652519796i;-0.0745859314629308 + 0.0649189140161230i;-0.0641324376396460 + 0.0691160531307607i;-0.0692096744351230 + 0.0639689178622285i;-0.0363780696261044 + 0.0864206315647123i;0.00109765874498660 + 0.113847484479864i;0.0190402059582902 + 0.112786678508626i;0.0363179071290403 + 0.0940381242055238i;0.0589082829105702 + 0.0885420967899655i;0.0667402235515048 + 0.0863352467896309i;0.0857408014459529 + 0.0565247017925322i;0.111133799642634 + 0.0428332035373765i;0.103262770150410 + 0.0208255374189399i;0.104632248080507 - 0.0285841848144768i;0.107831972971064 - 0.0372281310751551i;0.0866401961499636 - 0.0729638905830825i;0.0716453474018587 - 0.0891976670111795i;0.0510014335176055 - 0.106381315662297i;0.0327627377855410 - 0.104697551938465i;0.0132456713302394 - 0.116540332837775i;-0.0326449638906306 - 0.114709693830336i;-0.0560018683138425 - 0.100446567771649i;-0.0581175809874824 - 0.103701569332611i;-0.0863272396233080 - 0.0799184660825977i;-0.102626869584340 - 0.0442938555716883i;-0.0967321404243399 - 0.0252786252070149i;-0.118782678118988 - 0.00881354647691914i;-0.110418723314581 + 0.0315458273086624i;-0.0973010229954390 + 0.0491230282355698i;-0.0914004314325388 + 0.0712741769389668i;-0.0742950457461674 + 0.0833411520686508i;-0.0511068772505711 + 0.0825334483199997i;-0.0421898222858545 + 0.0984561175697726i;-0.0139849537165787 + 0.125335436073488i;0.00480415442351835 + 0.105289736372889i;0.0258246595082960 + 0.105164708480608i;0.0581316961488917 + 0.0968215566456930i;0.0734431359004805 + 0.0800270354594652i;0.0901258881944777 + 0.0686209952993643i;0.0936903749779104 + 0.0419869305120063i;0.119845914187333 + 0.0235570255894975i;0.116536991116259 + 0.00757362071645496i;0.116426949502367 - 0.00357173014039896i;0.126021722123456 - 0.0375351347586958i;0.0937887582723637 - 0.0533678232511244i;0.120627691161686 - 0.0713184658089285i;0.0949190692821925 - 0.116324735259952i;0.0903750262249268 - 0.117468845252619i;0.0622710135455191 - 0.156314230197253i;0.0109009150250652 - 0.189521892315402i;-0.0386805096157020 - 0.183761248064163i;-0.0620658568376119 - 0.187062961206988i;-0.159817260563773 - 0.179283636774738i;-0.166484770320291 - 0.144385599845394i;-0.205156083347863 - 0.0958383550912189i;-0.248310278240844 - 0.0625880140184167i;-0.262136130386530 - 0.0101274048598233i;-0.275061062029123 + 0.0713501953733080i;-0.263008189132144 + 0.107592521253174i;-0.243633725756528 + 0.203739744844940i;-0.181320664712819 + 0.263164043015088i;-0.116169746198297 + 0.324788589762081i;-0.0233791787458128 + 0.385154466857585i;0.0828282229535416 + 0.368334555936282i;0.173415670780835 + 0.345775392176877i;0.290928908628321 + 0.295412044999488i;0.366570279939890 + 0.233699347728848i;0.417314825511930 + 0.165259053505982i;0.457687185656200 - 0.00432002107464390i;0.468805475672037 - 0.106638729746616i;0.445224452547380 - 0.217543758461462i;0.346726862432398 - 0.346829769775092i;0.297413293996898 - 0.453206426747378i;0.142116033881967 - 0.559604078997771i;-0.0358129297624731 - 0.545366518832336i;-0.139060239550926 - 0.549218227137044i;-0.324652224723126 - 0.481065886883838i;-0.399418394094961 - 0.314935707890618i;-0.480677978822226 - 0.277632178563405i;-0.576563932157416 - 0.129608374809152i;-0.580483511468819 + 0.00481524030992731i;-0.609632672357728 + 0.138615792760680i;-0.586183446729543 + 0.319465388771309i;-0.437073618242177 + 0.473283235069343i;-0.303437199941164 + 0.564050654662464i;-0.134055088300777 + 0.680911173303716i;0.0518513665338570 + 0.680484141232801i;0.200614553631954 + 0.633970154486120i;0.367600996559259 + 0.569549567170067i;0.482694413130635 + 0.468599222878649i;0.564190883579667 + 0.339169314209200i;0.707148635134443 + 0.246682789957206i;0.721806414862168 + 0.0152942775143996i;0.719911589306792 - 0.204942024935751i;0.629292262044571 - 0.384884565470246i;0.550077908538216 - 0.568120781402267i;0.406346147581603 - 0.698059670844142i;0.195853345858260 - 0.782871563612683i;-0.0169877553193329 - 0.852560964977897i;-0.271425900804517 - 0.803801335245084i;-0.471495106918860 - 0.680954941468003i;-0.636827922801820 - 0.540661805475638i;-0.753225946008033 - 0.364580909213255i;-0.768597359148530 - 0.159271519173748i;-0.871960157616056 + 0.0543155451584542i;-0.805297642827994 + 0.223276913332071i;-0.738897279105378 + 0.500419127527259i;-0.625502970334801 + 0.606217093962438i;-0.451437185149881 + 0.809126495277554i;-0.185609774225121 + 0.918708023840609i;0.0669713149683009 + 0.950017284267136i;0.324391559181957 + 0.922892514290795i;0.573645458968314 + 0.792147848515062i;0.769154110583537 + 0.607828991831702i;0.880786648897123 + 0.382129205317062i;0.993737253916156 + 0.123889645905380i;0.978298253259103 - 0.124912165821087i;0.911071429538802 - 0.459601709138517i;0.771574891697602 - 0.646233516505707i;0.539116979889355 - 0.881543189076761i;0.268206499358275 - 0.959565936156922i;0.0214571050844324 - 0.993339068080146i;-0.278556978116317 - 0.995595742191950i;-0.580876776269760 - 0.820804218358898i;-0.802858278975862 - 0.658649640853321i;-0.993774717163804 - 0.269210296979878i;-1.00565356962976 - 0.0232835768738526i;-0.919911542720827 + 0.268344339893722i;-0.746348635130784 + 0.517903642930509i;-0.526353179155340 + 0.657462392763312i;-0.288901635857582 + 0.768158193338013i;-0.0679659541328951 + 0.761278201999892i;0.177280361121605 + 0.680574409050967i;0.349202687374419 + 0.569320247189181i;0.458731179234527 + 0.406449279562628i;0.508488643923101 + 0.260319391593421i;0.522959260812418 + 0.0666049594550131i;0.457770992272673 - 0.0754924040802469i;0.422333450249388 - 0.175547642485912i;0.271945363237905 - 0.263270786733261i;0.198415535893368 - 0.284121478670806i;0.110498322476716 - 0.297741997203409i;-0.00915515034642366 - 0.270432514231650i;-0.0444120844237880 - 0.233945254104510i;-0.0758518999195011 - 0.186077582815608i;-0.113562524130448 - 0.131199801283094i;-0.110485673444490 - 0.0989084248150003i;-0.117804181530032 - 0.0644102421854847i;-0.104148925852213 - 0.0371391675229720i;-0.102076323024668 - 0.0161752789812733i;-0.0807014379605993 - 7.80643775173267e-06i;-0.0635438512939540 + 0.00825263208795505i;-0.0651926210234338 + 0.0174060609281529i;-0.0539286297141520 + 0.0135361790151556i;-0.0544912901152086 + 0.0186561820722820i;-0.0534417186041452 + 0.0229047611872452i;-0.0523151652084749 + 0.0270257831129193i;-0.0500262488405593 + 0.0313784561793270i;-0.0412968212167192 + 0.0463429697431938i;-0.0366727795698088 + 0.0526869938920782i;-0.0280845724905922 + 0.0617592203352249i;-0.0144502605861842 + 0.0653286773894389i;-0.00223187395742870 + 0.0715196767308326i;0.0210790707981252 + 0.0679005453911669i;0.0349071098311460 + 0.0639103338008234i;0.0488784150414384 + 0.0543067350789514i;0.0599837927532717 + 0.0364961685802529i;0.0647269925748258 + 0.0210782320809158i;0.0637953686703935 + 0.00775291867899039i;0.0647904765715835 - 0.0125762336732904i;0.0539942872623424 - 0.0220721982299089i;0.0461940528776230 - 0.0332374090975502i;0.0363968921321443 - 0.0399329360910319i;0.0280677504216616 - 0.0458132769609549i;0.0129188769308658 - 0.0511853467567565i;0.00327288118085801 - 0.0483614951738756i;-0.00824190504089829 - 0.0461567069833879i;-0.0186328574616919 - 0.0391562399026345i;-0.0250638679640792 - 0.0330631366264652i;-0.0340320630527297 - 0.0245185788912941i;-0.0347283082337682 - 0.0143317686866838i;-0.0353700096993757 - 0.00665019537722029i;-0.0347077818727262 + 0.00328995631716861i;-0.0274607339088595 + 0.00997992347685785i;-0.0256874412334806 + 0.0150765341080195i;-0.0189925272540889 + 0.0188876540047961i;-0.0135736851341869 + 0.0202501786125324i;-0.0105758139081043 + 0.0226730532707356i;-0.00399644749639345 + 0.0212416212930098i;0.000575543514614792 + 0.0213876633422345i;0.00397189390609590 + 0.0194845062023483i;0.00775718606774129 + 0.0180708795209505i;0.0114992624212163 + 0.0144121918350077i;0.0125405817728375 + 0.0123419104192647i;0.0139550152384110 + 0.00756606291624676i;0.0145491767566831 + 0.00571939522445823i;0.0156694665650922 + 0.00238390349682151i;0.000755004882812500 + 0.00000000000000i;0.0156694665650922 - 0.00238390349682151i;0.0145491767566831 - 0.00571939522445823i;0.0139550152384110 - 0.00756606291624676i;0.0125405817728375 - 0.0123419104192647i;0.0114992624212163 - 0.0144121918350077i;0.00775718606774129 - 0.0180708795209505i;0.00397189390609590 - 0.0194845062023483i;0.000575543514614792 - 0.0213876633422345i;-0.00399644749639345 - 0.0212416212930098i;-0.0105758139081043 - 0.0226730532707356i;-0.0135736851341869 - 0.0202501786125324i;-0.0189925272540889 - 0.0188876540047961i;-0.0256874412334806 - 0.0150765341080195i;-0.0274607339088595 - 0.00997992347685785i;-0.0347077818727262 - 0.00328995631716861i;-0.0353700096993757 + 0.00665019537722029i;-0.0347283082337682 + 0.0143317686866838i;-0.0340320630527297 + 0.0245185788912941i;-0.0250638679640792 + 0.0330631366264652i;-0.0186328574616919 + 0.0391562399026345i;-0.00824190504089829 + 0.0461567069833879i;0.00327288118085801 + 0.0483614951738756i;0.0129188769308658 + 0.0511853467567565i;0.0280677504216616 + 0.0458132769609549i;0.0363968921321443 + 0.0399329360910319i;0.0461940528776230 + 0.0332374090975502i;0.0539942872623424 + 0.0220721982299089i;0.0647904765715835 + 0.0125762336732904i;0.0637953686703935 - 0.00775291867899039i;0.0647269925748258 - 0.0210782320809158i;0.0599837927532717 - 0.0364961685802529i;0.0488784150414384 - 0.0543067350789514i;0.0349071098311460 - 0.0639103338008234i;0.0210790707981252 - 0.0679005453911669i;-0.00223187395742870 - 0.0715196767308326i;-0.0144502605861842 - 0.0653286773894389i;-0.0280845724905922 - 0.0617592203352249i;-0.0366727795698088 - 0.0526869938920782i;-0.0412968212167192 - 0.0463429697431938i;-0.0500262488405593 - 0.0313784561793270i;-0.0523151652084749 - 0.0270257831129193i;-0.0534417186041452 - 0.0229047611872452i;-0.0544912901152086 - 0.0186561820722820i;-0.0539286297141520 - 0.0135361790151556i;-0.0651926210234338 - 0.0174060609281529i;-0.0635438512939540 - 0.00825263208795505i;-0.0807014379605993 + 7.80643775173267e-06i;-0.102076323024668 + 0.0161752789812733i;-0.104148925852213 + 0.0371391675229720i;-0.117804181530032 + 0.0644102421854847i;-0.110485673444490 + 0.0989084248150003i;-0.113562524130448 + 0.131199801283094i;-0.0758518999195011 + 0.186077582815608i;-0.0444120844237880 + 0.233945254104510i;-0.00915515034642366 + 0.270432514231650i;0.110498322476716 + 0.297741997203409i;0.198415535893368 + 0.284121478670806i;0.271945363237905 + 0.263270786733261i;0.422333450249388 + 0.175547642485912i;0.457770992272673 + 0.0754924040802469i;0.522959260812418 - 0.0666049594550131i;0.508488643923101 - 0.260319391593421i;0.458731179234527 - 0.406449279562628i;0.349202687374419 - 0.569320247189181i;0.177280361121605 - 0.680574409050967i;-0.0679659541328951 - 0.761278201999892i;-0.288901635857582 - 0.768158193338013i;-0.526353179155340 - 0.657462392763312i;-0.746348635130784 - 0.517903642930509i;-0.919911542720827 - 0.268344339893722i;-1.00565356962976 + 0.0232835768738526i;-0.993774717163804 + 0.269210296979878i;-0.802858278975862 + 0.658649640853321i;-0.580876776269760 + 0.820804218358898i;-0.278556978116317 + 0.995595742191950i;0.0214571050844324 + 0.993339068080146i;0.268206499358275 + 0.959565936156922i;0.539116979889355 + 0.881543189076761i;0.771574891697602 + 0.646233516505707i;0.911071429538802 + 0.459601709138517i;0.978298253259103 + 0.124912165821087i;0.993737253916156 - 0.123889645905380i;0.880786648897123 - 0.382129205317062i;0.769154110583537 - 0.607828991831702i;0.573645458968314 - 0.792147848515062i;0.324391559181957 - 0.922892514290795i;0.0669713149683009 - 0.950017284267136i;-0.185609774225121 - 0.918708023840609i;-0.451437185149881 - 0.809126495277554i;-0.625502970334801 - 0.606217093962438i;-0.738897279105378 - 0.500419127527259i;-0.805297642827994 - 0.223276913332071i;-0.871960157616056 - 0.0543155451584542i;-0.768597359148530 + 0.159271519173748i;-0.753225946008033 + 0.364580909213255i;-0.636827922801820 + 0.540661805475638i;-0.471495106918860 + 0.680954941468003i;-0.271425900804517 + 0.803801335245084i;-0.0169877553193329 + 0.852560964977897i;0.195853345858260 + 0.782871563612683i;0.406346147581603 + 0.698059670844142i;0.550077908538216 + 0.568120781402267i;0.629292262044571 + 0.384884565470246i;0.719911589306792 + 0.204942024935751i;0.721806414862168 - 0.0152942775143996i;0.707148635134443 - 0.246682789957206i;0.564190883579667 - 0.339169314209200i;0.482694413130635 - 0.468599222878649i;0.367600996559259 - 0.569549567170067i;0.200614553631954 - 0.633970154486120i;0.0518513665338570 - 0.680484141232801i;-0.134055088300777 - 0.680911173303716i;-0.303437199941164 - 0.564050654662464i;-0.437073618242177 - 0.473283235069343i;-0.586183446729543 - 0.319465388771309i;-0.609632672357728 - 0.138615792760680i;-0.580483511468819 - 0.00481524030992731i;-0.576563932157416 + 0.129608374809152i;-0.480677978822226 + 0.277632178563405i;-0.399418394094961 + 0.314935707890618i;-0.324652224723126 + 0.481065886883838i;-0.139060239550926 + 0.549218227137044i;-0.0358129297624731 + 0.545366518832336i;0.142116033881967 + 0.559604078997771i;0.297413293996898 + 0.453206426747378i;0.346726862432398 + 0.346829769775092i;0.445224452547380 + 0.217543758461462i;0.468805475672037 + 0.106638729746616i;0.457687185656200 + 0.00432002107464390i;0.417314825511930 - 0.165259053505982i;0.366570279939890 - 0.233699347728848i;0.290928908628321 - 0.295412044999488i;0.173415670780835 - 0.345775392176877i;0.0828282229535416 - 0.368334555936282i;-0.0233791787458128 - 0.385154466857585i;-0.116169746198297 - 0.324788589762081i;-0.181320664712819 - 0.263164043015088i;-0.243633725756528 - 0.203739744844940i;-0.263008189132144 - 0.107592521253174i;-0.275061062029123 - 0.0713501953733080i;-0.262136130386530 + 0.0101274048598233i;-0.248310278240844 + 0.0625880140184167i;-0.205156083347863 + 0.0958383550912189i;-0.166484770320291 + 0.144385599845394i;-0.159817260563773 + 0.179283636774738i;-0.0620658568376119 + 0.187062961206988i;-0.0386805096157020 + 0.183761248064163i;0.0109009150250652 + 0.189521892315402i;0.0622710135455191 + 0.156314230197253i;0.0903750262249268 + 0.117468845252619i;0.0949190692821925 + 0.116324735259952i;0.120627691161686 + 0.0713184658089285i;0.0937887582723637 + 0.0533678232511244i;0.126021722123456 + 0.0375351347586958i;0.116426949502367 + 0.00357173014039896i;0.116536991116259 - 0.00757362071645496i;0.119845914187333 - 0.0235570255894975i;0.0936903749779104 - 0.0419869305120063i;0.0901258881944777 - 0.0686209952993643i;0.0734431359004805 - 0.0800270354594652i;0.0581316961488917 - 0.0968215566456930i;0.0258246595082960 - 0.105164708480608i;0.00480415442351835 - 0.105289736372889i;-0.0139849537165787 - 0.125335436073488i;-0.0421898222858545 - 0.0984561175697726i;-0.0511068772505711 - 0.0825334483199997i;-0.0742950457461674 - 0.0833411520686508i;-0.0914004314325388 - 0.0712741769389668i;-0.0973010229954390 - 0.0491230282355698i;-0.110418723314581 - 0.0315458273086624i;-0.118782678118988 + 0.00881354647691914i;-0.0967321404243399 + 0.0252786252070149i;-0.102626869584340 + 0.0442938555716883i;-0.0863272396233080 + 0.0799184660825977i;-0.0581175809874824 + 0.103701569332611i;-0.0560018683138425 + 0.100446567771649i;-0.0326449638906306 + 0.114709693830336i;0.0132456713302394 + 0.116540332837775i;0.0327627377855410 + 0.104697551938465i;0.0510014335176055 + 0.106381315662297i;0.0716453474018587 + 0.0891976670111795i;0.0866401961499636 + 0.0729638905830825i;0.107831972971064 + 0.0372281310751551i;0.104632248080507 + 0.0285841848144768i;0.103262770150410 - 0.0208255374189399i;0.111133799642634 - 0.0428332035373765i;0.0857408014459529 - 0.0565247017925322i;0.0667402235515048 - 0.0863352467896309i;0.0589082829105702 - 0.0885420967899655i;0.0363179071290403 - 0.0940381242055238i;0.0190402059582902 - 0.112786678508626i;0.00109765874498660 - 0.113847484479864i;-0.0363780696261044 - 0.0864206315647123i;-0.0692096744351230 - 0.0639689178622285i;-0.0641324376396460 - 0.0691160531307607i;-0.0745859314629308 - 0.0649189140161230i;-0.0697606000706588 - 0.0334513652519796i;-0.0775831910582389 - 0.0303897023891404i;-0.0962113628137208 - 0.0186574440413172i;-0.100654795289144 - 0.00980936521224955i;-0.133058915121188 - 0.0193850442269401i;-0.125068088207384 + 0.0419056490826946i;-0.121022640233632 + 0.0743951129863777i;-0.0915362573618112 + 0.120870741449549i;-0.0522689694336260 + 0.151978823677644i;-0.0132004980389885 + 0.147640542784997i;0.0271850978971708 + 0.155018556686167i;0.0486777333286202 + 0.145940318016716i;0.0790817583436108 + 0.153839556332606i;0.138971966117350 + 0.0983227903551719i;0.153137060968825 + 0.117705631198029i;0.229552866478961 + 0.0217906472771969i;0.246771081042966 - 0.0386790766141766i;0.244268298139887 - 0.119212559373841i;0.176963251898272 - 0.207633972459545i;0.0942101212521723 - 0.273431179359133i;-0.0227604228872568 - 0.271700254609744i;-0.103360637969971 - 0.259035931534960i;-0.153676638235634 - 0.200429201600013i;-0.228785094796284 - 0.126913083744720i;-0.216704967608849 - 0.0632272190871281i;-0.248353193619903 + 0.00100781015329328i;-0.259404984686327 + 0.101964186112656i;-0.175806212485551 + 0.196430104698557i;-0.107659359229499 + 0.298720087679902i;0.0569408011947115 + 0.281808544784904i;0.166554672049608 + 0.185047592513926i;0.197298077717305 + 0.0450272907468386i;0.144943727448516 - 0.0778175248431117i;0.0804985736320079 - 0.0684392087778033i;0.0152258876083884 - 0.0807562227802350i;0.0186438185551273 - 0.0187395250191680i;-0.00719753257612951 - 0.00549519938167638i;0.0126369810011458 - 0.000262600587259238i;0.0232951369021420 + 0.00346971195142102i;0.0345142021386878 - 0.0210122532636355i;0.0435158313404098 - 0.0202034460915909i;0.0505949921308971 - 0.0646566273135022i;-0.0225572394558732 - 0.0592930695044879i;-0.0490006746043663 - 0.0275307554384524i;-0.0522823062311627 + 0.00212336424984206i;-0.0299092242827132 + 0.0365345960400933i;0.0226708141218227 + 0.0234579334645852i;0.0117908549301265 + 0.000378047020321038i;0.00845581914439554 - 0.00387048165844497i;-0.00268686011712669 - 0.00727217667218528i;-0.00208413372040777 - 0.00983238817301692i;-0.00940108282148506 - 0.000147610288721709i;-0.0273041397129701 - 0.00478292159947905i;-0.00335964274139229 + 0.00631631036688940i;0.00129675694907157 - 0.000516387108681213i;0.000367564466351748 + 0.0146857500857929i;-0.00358054940723795 + 0.00229418123580474i;-0.0382808853327221 + 0.0200561180921658i;-0.0422749463202110 - 0.0405747642497566i;],1,P);
    
     figure()
     plot(htest(:,1:2:8))
     figure()
     plot(20*log(abs(channel_est(:,1:2:8))));
     ylim([-150 0]); xlim([0 256]);
        size(channel_est)
     packetd_scaled = packetd./channel_est(3:2:N/2-1,:);

    rxQamStream = reshape(packetd_scaled,floor((N/2-1)/2)*P,1);
    
end